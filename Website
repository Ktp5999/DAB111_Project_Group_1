# Importing the libraries 
import sqlite3
import pandas as pd
import csv
from flask import Flask, render_template_string, render_template
from werkzeug.serving import run_simple

# Importing the dataset (Netflix)
df = pd.read_csv("C:/Users/Lenovo/OneDrive - St. Clair College/SEM_1/DAB 111 Pyhton Programming/netflix1.csv")
df.head(10)

# Craeting a database
con = sqlite3.connect('Netflix.db')
cursor = con.cursor()

# Creating a table (movies)
create_table = """CREATE TABLE IF NOT EXISTS movies(
                        show_id VARCHAR(50) PRIMARY KEY,
                        type VARCHAR(20),
                        title VARCHAR(255),
                        director VARCHAR(255),
                        country VARCHAR(100),
                        date_added DATE,
                        release_year INT,
                        rating VARCHAR(10),
                        duration VARCHAR(20),
                        listed_in VARCHAR(255)
                        )"""
cursor.execute(create_table)
df.to_sql('movies', con, if_exists='replace', index=False)

con.commit()
con.close()


@app.route('/')
def home():
    return render_template('index.html')

@app.route('/about')
def about():
    return render_template('about.html')

@app.route('/data')
def data():
    conn = sqlite3.connect('../database/your_database.db')
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM your_table LIMIT 100")
    data = cursor.fetchall()
    conn.close()
    return render_template('data.html', data=data)

if __name__ == '__main__':
    app.run(debug=True)
